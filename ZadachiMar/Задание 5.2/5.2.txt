#include <iostream>
#include "string.h"
#include "time.h"
#include <Windows.h>
using namespace std;

int main()
{
    srand(time(0));
    SetConsoleCP(1251);//добавляем русскую локализацию
    SetConsoleOutputCP(1251);
    cout << "Привет мир!" << endl; //тест локализации
    cout << "\nАлфавит от А до Я:" << endl;

    string alphabet;
    alphabet = "АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ";

    //Символы русского алфавита кодируются как 2 символа на латинице.

//    for(int index = 'a';index<='z';index++)
//    {
//        alphabet.push_back((char)index);
//    }


    cout << alphabet << endl;
    string perm_alpha = alphabet;

    // В цикле происходит перемешивание алфавита
    for (int i = 0; i < 100; i++)
    {
        int index1 = 0;
        int index2 = 0;

        index1 = (rand() * 2) % perm_alpha.size();
        index2 = (rand() * 2) % perm_alpha.size();

        swap(perm_alpha[index1], perm_alpha[index2]);
        swap(perm_alpha[index1 + 1], perm_alpha[index2 + 1]); //делаем данное действие только благодаря русскому языку
    }

    cout << "\nАлфавит после пермешивания:\n" << perm_alpha << endl;

    string word;
    cout << "\nВведи осмысленную фразу:\n";
    cin >> word;

    //ЗАЩИТА
    for (int i = 0; i < word.size(); i++)
    {
        if (alphabet.find(word[i]) == string::npos) //проверим есть ли в алафавите эти символы
        {
            cout << "Введено неправильное значение строки" << endl;
            return 1;
        }
    }

    for (int i = 0; i < word.size(); i++)
    {
        int index1 = alphabet.find(word[i]); //Узнаем какой индекс этого символа в алфавите
        word[i] = perm_alpha[index1];   // По этому индексу заменяем символ на другой из второго алфавита
    }
    cout << "Зашифрованный текст:" << word << endl;


    //Для тех кому нравится смотреть на повторный код без применения функций (Расшифрование)
    for (int i = 0; i < word.size(); i++)
    {
        int index1 = perm_alpha.find(word[i]); //Узнаем какой индекс этого символа в алфавите
        word[i] = alphabet[index1];   // По этому индексу заменяем символ на другой из второго алфавита
    }
    cout << "Расшифрованный текст:" << word << endl;

    return 0;
}